@{
    ViewData["Title"] = "Trợ lý AI - MotorShop";
    // Giữ nguyên Layout mặc định để có Header/Footer
    Layout = "_Layout";
    ViewData["HideFooter"] = true;
}

@section Head {
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="~/css/ai.css" />
}

<div class="ai-page-wrapper">

    <canvas id="magnetic-canvas"></canvas>

    <div id="side-backdrop" class="sidebar-backdrop" onclick="closeSidebar()"></div>
    <div id="product-sidebar" class="product-sidebar">
        <div class="sidebar-header">
            <span class="sidebar-heading">Chi tiết sản phẩm</span>
            <button class="btn-close-sidebar" onclick="closeSidebar()">
                <i class="fa-solid fa-xmark"></i>
            </button>
        </div>

        <div class="sidebar-scroll-area">
            <div class="hero-image-container">
                <div id="sb-badge-brand" class="floating-badge">
                    <i class="fa-solid fa-copyright text-blue-500"></i>
                    <span id="sb-brand-text">Honda</span>
                </div>
                <img id="sb-image" src="" class="sidebar-img" alt="Product Image">
            </div>

            <div class="info-container">
                <div id="sb-category-small" class="category-tag">Xe Tay Ga</div>
                <h2 id="sb-name" class="product-title">Tên sản phẩm</h2>

                <div class="price-wrapper">
                    <span id="sb-price" class="current-price">0 đ</span>
                    <span id="sb-stock" class="stock-status">Sẵn hàng</span>
                </div>

                <div class="ai-insight-box">
                    <div class="ai-icon-float"><i class="fa-solid fa-wand-magic-sparkles"></i></div>
                    <div class="ai-label">AI GỢI Ý VÌ:</div>
                    <div id="sb-reason" class="ai-reason-text"></div>
                </div>

                <div class="sidebar-section-title">Thông số nổi bật</div>
                <div class="specs-grid-modern">
                    <div class="spec-card">
                        <span class="spec-label">Năm SX</span>
                        <span id="sb-year" class="spec-val">2024</span>
                    </div>
                    <div class="spec-card">
                        <span class="spec-label">Mã SKU</span>
                        <span id="sb-sku" class="spec-val">...</span>
                    </div>
                    <div class="spec-card">
                        <span class="spec-label">Loại xe</span>
                        <span id="sb-category-val" class="spec-val">...</span>
                    </div>
                </div>

                <div class="sidebar-section-title">Mô tả chi tiết</div>
                <div id="sb-desc" class="desc-content"></div>
            </div>
        </div>

        <div class="sidebar-sticky-footer">
            <button id="sb-btn-link" class="btn-primary-action">
                Xem chi tiết & Mua ngay <i class="fa-solid fa-arrow-right-long"></i>
            </button>
        </div>
    </div>

    <div id="scroll-wrapper" class="chat-zone">

        <div id="hero-view" class="hero-box">
            <div class="hero-icon-box">
                <div class="inner-icon"></div>
            </div>

            <h1 class="hero-title">Trợ lý AI MotorShop</h1>
            <p class="hero-sub">Sử dụng công nghệ trí tuệ nhân tạo để tìm chiếc xe hoàn<br>hảo cho phong cách của bạn.</p>

            <div class="suggestion-container">
                <div class="gravity-grid">
                    <button class="gravity-card" onclick="usePrompt('Tôi cần tìm xe tay ga cho nữ văn phòng, cốp rộng')">
                        <div class="g-icon"><i class="fa-solid fa-person-dress"></i></div>
                        <div class="g-info">
                            <span class="g-title">Xe cho nữ văn phòng</span>
                            <span class="g-sub">Đẹp, nhẹ & tiện dụng</span>
                        </div>
                    </button>
                    <button class="gravity-card" onclick="usePrompt('Gợi ý xe côn tay thể thao đi phượt tốt nhất')">
                        <div class="g-icon"><i class="fa-solid fa-motorcycle"></i></div>
                        <div class="g-info">
                            <span class="g-title">Xe côn tay đi phượt</span>
                            <span class="g-sub">Exciter, Winner X...</span>
                        </div>
                    </button>
                    <button class="gravity-card" onclick="usePrompt('So sánh ưu nhược điểm của Vision và Janus')">
                        <div class="g-icon"><i class="fa-solid fa-scale-balanced"></i></div>
                        <div class="g-info">
                            <span class="g-title">So sánh xe</span>
                            <span class="g-sub">Phân tích ưu nhược điểm</span>
                        </div>
                    </button>
                    <button class="gravity-card" onclick="usePrompt('Xu hướng xe máy mới nhất năm 2024')">
                        <div class="g-icon"><i class="fa-solid fa-calendar-check"></i></div>
                        <div class="g-info">
                            <span class="g-title">Xu hướng mới nhất</span>
                            <span class="g-sub">Cập nhật thị trường</span>
                        </div>
                    </button>
                </div>
            </div>
        </div>

        <div id="chat-content"></div>

        <div id="loading-spinner" class="hidden" style="display: none; padding: 30px 0; text-align: center;">
            <i class="fa-solid fa-circle-notch fa-spin text-blue-500 text-2xl"></i>
            <p class="text-xs text-slate-400 mt-2">Đang suy nghĩ...</p>
        </div>
    </div>

    <div class="invisible-dock">
        <div class="glass-capsule">
            <i class="fa-solid fa-wand-magic-sparkles text-slate-400"></i>
            <input id="ai-input" type="text" class="ghost-input" placeholder="Hỏi tôi bất cứ điều gì..." autocomplete="off">
            <button id="ai-send" class="btn-ios-send"><i class="fa-solid fa-arrow-up"></i></button>
        </div>
    </div>
</div>

<script src="~/js/ai.js"></script>