@model MotorShop.ViewModels.PartsListViewModel
@using Microsoft.AspNetCore.Mvc.Rendering
@{
    ViewData["Title"] = "Phụ tùng & Linh kiện";
}

<section class="relative overflow-hidden bg-slate-950">
    <div class="absolute inset-0 bg-[radial-gradient(circle_at_top,_rgba(16,185,129,.3)_0%,rgba(15,23,42,0)_42%),linear-gradient(120deg,#0f172a_0%,#064e3b_46%,#10b981_100%)] opacity-95"></div>

    <div class="pointer-events-none absolute inset-0 opacity-[0.12]"
         style="background-image: radial-gradient(circle, rgba(255,255,255,.25) 1px, transparent 1px); background-size: 46px 46px;">
    </div>

    <div class="relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-14 md:py-16 flex flex-col md:flex-row gap-10 items-center justify-between">
        <div class="max-w-xl text-white">
            <p class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/10 text-[11px] tracking-[.25em] uppercase mb-4">
                <i class="fa-solid fa-gears text-xs"></i> MotorShop / Phụ tùng
            </p>
            <h1 class="text-3xl md:text-4xl lg:text-5xl font-extrabold leading-tight drop-shadow-sm">
                Nâng cấp xế yêu,<br />
                <span class="text-emerald-300">Vận hành êm ái.</span>
            </h1>
            <p class="mt-3 text-white/80 text-sm md:text-base">
                Cung cấp phụ tùng chính hãng Honda, Yamaha, VinFast... Bảo hành uy tín, giá tốt.
            </p>

            <form asp-controller="Products" asp-action="Parts" method="get" class="mt-6" novalidate>
                <div class="relative max-w-lg">
                    <input name="search" value="@Model.Search"
                           type="search" autocomplete="off"
                           placeholder="Nhập tên phụ tùng, mã sản phẩm..."
                           class="w-full rounded-2xl bg-white text-slate-900 pl-11 pr-4 py-3 shadow-lg/70
                                  focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:border-emerald-400" />
                    <i class="fa-solid fa-magnifying-glass absolute left-4 top-1/2 -translate-y-1/2 text-slate-400"></i>
                </div>
            </form>

            <div class="mt-4 flex flex-wrap gap-2 text-xs text-white/70">
                <a href="@Url.Action("Parts", new { brand = "Honda" })" class="px-3 py-1 rounded-full bg-white/10 border border-white/10 hover:bg-white/20">Honda</a>
                <a href="@Url.Action("Parts", new { brand = "Yamaha" })" class="px-3 py-1 rounded-full bg-white/10 border border-white/10 hover:bg-white/20">Yamaha</a>
                <a href="@Url.Action("Parts", new { brand = "Michelin" })" class="px-3 py-1 rounded-full bg-white/10 border border-white/10 hover:bg-white/20">Lốp xe</a>
            </div>
        </div>

        <div class="w-full md:w-auto flex gap-4 items-stretch">
            <div class="grid grid-cols-2 gap-4 min-w-[200px]">
                <div class="rounded-2xl bg-white/10 backdrop-blur-sm border border-white/10 px-4 py-5 text-white">
                    <div class="text-3xl font-extrabold">@Model.TotalItems</div>
                    <div class="text-[11px] uppercase tracking-wide mt-2 text-white/70">Sản phẩm</div>
                </div>
                <div class="rounded-2xl bg-white/10 backdrop-blur-sm border border-white/10 px-4 py-5 text-white">
                    <div class="text-3xl font-extrabold">100%</div>
                    <div class="text-[11px] uppercase tracking-wide mt-2 text-white/70">Chính hãng</div>
                </div>
                <div class="col-span-2 rounded-2xl bg-slate-950/20 border border-white/10 px-4 py-3 text-white/80 text-xs flex items-center gap-2">
                    <i class="fa-solid fa-wrench text-emerald-300"></i>
                    Hỗ trợ lắp đặt tại cửa hàng.
                </div>
            </div>
        </div>
    </div>
</section>

<section class="bg-slate-50 py-10 md:py-12">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 grid grid-cols-1 lg:grid-cols-4 gap-8">

        <aside class="lg:col-span-1">
            <div class="bg-white rounded-2xl border border-slate-100 shadow-sm sticky top-24">
                <button type="button"
                        class="w-full flex items-center justify-between px-6 py-4 lg:hidden"
                        onclick="document.getElementById('filterBody').classList.toggle('hidden')">
                    <span class="text-base font-semibold text-slate-900">Bộ lọc</span>
                    <i class="fa-solid fa-sliders text-slate-500"></i>
                </button>

                <form method="get" class="px-6 pb-6 lg:pt-6 space-y-6 hidden lg:block" id="filterBody">

                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Tìm kiếm</label>
                        <div class="relative">
                            <i class="fa-solid fa-magnifying-glass absolute left-3 top-1/2 -translate-y-1/2 text-slate-300"></i>
                            <input name="search" value="@Model.Search"
                                   class="w-full border-slate-200 rounded-xl shadow-sm pl-10 focus:ring-emerald-500 focus:border-emerald-500"
                                   placeholder="Tên, mã phụ tùng..." />
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Hãng xe</label>
                        <div class="space-y-2">
                            @{
                                var brands = new[] { "Honda", "Yamaha", "VinFast", "Suzuki", "Piaggio" };
                            }
                            <label class="flex items-center gap-3 cursor-pointer group">
                                <input type="radio" name="brand" value="" @(string.IsNullOrEmpty(Model.CurrentBrand) ? "checked" : "")
                                       class="w-4 h-4 text-emerald-600 border-slate-300 focus:ring-emerald-500 cursor-pointer" />
                                <span class="text-sm text-slate-600 group-hover:text-emerald-700">Tất cả</span>
                            </label>
                            @foreach (var b in brands)
                            {
                                <label class="flex items-center gap-3 cursor-pointer group">
                                    <input type="radio" name="brand" value="@b" @(Model.CurrentBrand == b ? "checked" : "")
                                           class="w-4 h-4 text-emerald-600 border-slate-300 focus:ring-emerald-500 cursor-pointer" />
                                    <span class="text-sm text-slate-600 group-hover:text-emerald-700">@b</span>
                                </label>
                            }
                        </div>
                    </div>

                    <div class="flex gap-2 pt-1">
                        <button type="submit"
                                class="flex-1 inline-flex justify-center items-center gap-2 py-2.5 bg-emerald-600 text-white font-semibold rounded-xl hover:bg-emerald-700 shadow-sm transition">
                            <i class="fa-solid fa-filter"></i> Áp dụng
                        </button>
                        <a asp-action="Parts" class="px-3 py-2.5 text-sm font-medium border rounded-xl hover:bg-slate-50 text-slate-600 text-center transition">Xoá</a>
                    </div>
                </form>
            </div>
        </aside>

        <div class="lg:col-span-3 space-y-6">

            <div class="bg-white p-4 rounded-2xl border border-slate-100 shadow-sm flex flex-col sm:flex-row sm:items-center justify-between gap-3">
                <div class="text-sm text-slate-600">
                    Hiển thị <strong>@Model.Items.Count()</strong> / <strong>@Model.TotalItems</strong> sản phẩm
                    @if (!string.IsNullOrEmpty(Model.Search))
                    {
                        <span> cho từ khoá <span class="font-medium text-slate-900">"@Model.Search"</span>.</span>
                    }
                </div>

                @if (!string.IsNullOrEmpty(Model.CurrentBrand))
                {
                    <span class="inline-flex items-center gap-1 px-3 py-1 bg-emerald-50 text-emerald-700 text-xs font-semibold rounded-full border border-emerald-100">
                        Hãng: @Model.CurrentBrand
                        <a asp-action="Parts" asp-route-search="@Model.Search" class="ml-1 hover:text-red-500"><i class="fa-solid fa-xmark"></i></a>
                    </span>
                }
            </div>

            @if (Model.Items.Any())
            {
                <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-6 mb-8">
                    @foreach (var p in Model.Items)
                    {
                        <partial name="_ProductCardPartial" model="p" />
                    }
                </div>

                @if (Model.TotalPages > 1)
                {
                    <div class="mt-10 flex justify-center">
                        <nav class="inline-flex bg-white rounded-xl shadow-sm border border-slate-200 p-1">
                            <a asp-action="Parts"
                               asp-route-page="@(Model.Page > 1 ? Model.Page - 1 : 1)"
                               asp-route-brand="@Model.CurrentBrand"
                               asp-route-search="@Model.Search"
                               class="px-4 py-2 text-sm font-medium text-slate-500 hover:text-emerald-600 hover:bg-emerald-50 rounded-lg transition @(Model.Page == 1 ? "pointer-events-none opacity-50" : "")">
                                <i class="fa-solid fa-chevron-left"></i>
                            </a>

                            @for (var i = 1; i <= Model.TotalPages; i++)
                            {
                                if (i == 1 || i == Model.TotalPages || (i >= Model.Page - 1 && i <= Model.Page + 1))
                                {
                                    <a asp-action="Parts"
                                       asp-route-page="@i"
                                       asp-route-brand="@Model.CurrentBrand"
                                       asp-route-search="@Model.Search"
                                       class="px-4 py-2 text-sm font-bold rounded-lg transition @(i == Model.Page ? "bg-emerald-600 text-white shadow-md" : "text-slate-600 hover:bg-slate-50")">
                                        @i
                                    </a>
                                }
                                else if (i == Model.Page - 2 || i == Model.Page + 2)
                                {
                                    <span class="px-2 py-2 text-slate-400">...</span>
                                }
                            }

                            <a asp-action="Parts"
                               asp-route-page="@(Model.Page<Model.TotalPages? Model.Page + 1 : Model.TotalPages)"
                               asp-route-brand="@Model.CurrentBrand"
                               asp-route-search="@Model.Search"
                               class="px-4 py-2 text-sm font-medium text-slate-500 hover:text-emerald-600 hover:bg-emerald-50 rounded-lg transition @(Model.Page == Model.TotalPages ? "pointer-events-none opacity-50" : "")">
                                <i class="fa-solid fa-chevron-right"></i>
                            </a>
                        </nav>
                    </div>
                }
            }
            else
            {
                <div class="text-center py-20 bg-white border border-slate-100 rounded-2xl shadow-sm">
                    <div class="flex items-center justify-center h-16 w-16 mx-auto bg-emerald-100 rounded-full mb-4">
                        <i class="fas fa-search-minus text-3xl text-emerald-600"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-slate-900 mb-2">Không tìm thấy phụ tùng nào</h3>
                    <p class="text-slate-500 mb-6">Thử bộ lọc khác hoặc xoá bộ lọc hiện tại.</p>
                    <a asp-action="Parts"
                       class="inline-block bg-emerald-600 text-white px-6 py-2.5 rounded-xl font-semibold hover:bg-emerald-700 transition shadow-sm shadow-emerald-200">
                        Xoá tất cả bộ lọc
                    </a>
                </div>
            }
        </div>
    </div>
</section>